<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Kiso</title>
  <meta name="viewport" content="width=device-width">
  <link rel="stylesheet" href="main.css">
</head>
<body>
  <video id="video" preload data-butter="media" controls>
    <source id="mp4" src="http://www.pbs.org/newshour/video/2011/specials/SOTU/20110125_sotu.mp4" type="video/mp4">
    <source id="ogv" src="http://www.pbs.org/newshour/video/2011/specials/SOTU/20110125_sotu.ogv" type="video/ogg">
  </video>
  <script src="/socket.io/socket.io.js"></script>
  <script src="popcorn.js"></script>
  <script src="popcorn.live.js"></script>
  <script>
    document.addEventListener( "DOMContentLoaded", function(){
      var socket = io.connect('http://192.168.1.110:7777'),
          p = Popcorn( "#video" ),
          data;

      data = Popcorn.xhr({
        url: "data/transcript.json",
        dataType: "json",
        success: function( data ) {
          data = data.data;
          for ( var i = 0, l = 10; i < l; i++ ) {
            p.livecredits({
              start: data[ i ].start,
              end: data[ i ].end,
              key: data[ i ].id
            });
          }
        }
      });

      socket.on('remote', function ( data ) {
        console.log( data );
        if ( data.e === "pause" ) {
          p.pause();
        }
        if ( data.e === "play" ) {
          if ( data.time ) {
            p.currentTime( data.time );
          }
          p.play();
        }
       });

    }, false);
  </script>
</body>
</html>
